<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head>Ciao</h:head>

<h:body>

	
		<h:form id="form">	
		
		<p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />	

		<p:selectOneRadio id="persone" style="margin:0 auto" value="#{bookBean.persone}">
								<f:selectItem itemLabel="1" itemValue="1" />
								<f:selectItem itemLabel="2" itemValue="2" />
								<f:selectItem itemLabel="3" itemValue="3" />
								<f:selectItem itemLabel="4" itemValue="4" />
								<f:selectItem itemLabel="5" itemValue="5" />
								<f:selectItem itemLabel="6" itemValue="6" />
		</p:selectOneRadio>
		
		<h:panelGrid id="displayHotel" columns="2" cellpadding="4">  
  
              
  
            <h:outputText value="Nome:" />  
            <h:outputText value="#{frontendBean.pacchetto.hotel.nome}" style="font-weight:bold"/>  
  
            <h:outputText value="Stelle:" />  
            <h:outputText value="#{frontendBean.pacchetto.hotel.stelle}" style="font-weight:bold"/>  
  
            <h:outputText value="Località:" />  
            <h:outputText value="#{frontendBean.pacchetto.hotel.luogo}" style="font-weight:bold"/>  
  
            <h:outputText value="Descrizione:" />  
            <h:outputText value="#{frontendBean.pacchetto.hotel.descrizione}" style="font-weight:bold"/>  
            
            <h:outputText value="Posti Disponibili:" />  
            <h:outputText value="#{frontendBean.pacchetto.hotel.disponibilita}" style="font-weight:bold"/>
              
            <h:outputText value="Costo Giornaliero:" />  
            <h:outputText value="#{frontendBean.pacchetto.hotel.costoGiornaliero}" style="font-weight:bold"/>
            
            
            <p:commandButton value="Cambia Hotel" styleClass="btn btn-default"
						actionListener="#{bookBean.goToCambiaHotel(event,frontendBean.pacchetto)}" 
						update=":form:formHotel:hotelDisponibili"			
						/>
              
       		</h:panelGrid>

		<p:dataTable id="dataTableAttivita" var="attivita"
			value="#{frontendBean.pacchetto.attivitaSecondarie}" lazy="true">
			<f:facet name="header">  
                Elenco Attivita Secondarie 
       		    </f:facet>
			<p:column sortBy="nome" headerText="Nome">
				<h:outputText value="#{attivita.nome}" />
			</p:column>

			<p:column sortBy="costoGiornaliero" headerText="Costo">
				<h:outputText value="#{attivita.costo} €" />
			</p:column>

			<p:column sortBy="luogo" headerText="Luogo">
				<h:outputText value="#{attivita.localita}" />
			</p:column>
			<p:column sortBy="disponibilita" headerText="Posti disponibili">
				<h:outputText value="#{attivita.disponibilita}" />
			</p:column>
			
			<p:column>
					<h:commandLink id="eliminaAttivita" value="Scegli"
						class="btn btn-danger white"
						action="#{bookBean.eliminaAttivita(action,attivita, frontendBean.pacchetto)}">
						<p:ajax execute="eliminaAttivita"  update="dataTableAttivita,:form:dataTableAttivita2" />
					</h:commandLink>
			</p:column>


		</p:dataTable>
		
		<p:commandButton value="Cambia Attività" styleClass="btn btn-default"
						actionListener="#{bookBean.goToCambiaAttivita(event,frontendBean.pacchetto)}" 
						update=":form:dataTableAttivita2"			
						/>

		<div class="col-md-4 col-md-offset-2">
			<p:calendar value="#{bookBean.date1}" mode="inline"
									id="inlineCal1" mindate="#{frontendBean.pacchetto.inizioValidita}" maxdate="#{frontendBean.pacchetto.fineValidita}"/>
			</div>
			<div class="col-md-4 col-md-offset-1">
				<p:calendar value="#{bookBean.date2}" mode="inline"
									id="inlineCal2" mindate="#{frontendBean.pacchetto.inizioValidita}" maxdate="#{frontendBean.pacchetto.fineValidita}"/>
			</div>
			 
			<p:commandButton value="Check Availability" styleClass="btn btn-default"
						actionListener="#{bookBean.checkDisponibilitaPacchetto(event,frontendBean.pacchetto)}" 
						update=":form:prenota:displayAndata,:form:prenota:displayRitorno"			
						/>
						
						
		
		<p:dialog header="Voli" widgetVar="voliDialog" resizable="false">
			<h:form id="prenota">
				<p:dataTable id="displayAndata" var="volo"
					value="#{bookBean.listaVoliAndata}"  selection="#{bookBean.voloAndata}" selectionMode="single" rowKey="#{volo.id}">
					<f:facet name="header"> Andata  </f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo.costo} €" />
					</p:column>
					
					
				</p:dataTable>

				<p:dataTable id="displayRitorno" var="volo_r"
					value="#{bookBean.listaVoliRitorno}" selection="#{bookBean.voloRitorno}" selectionMode="single" rowKey="#{volo_r.id}">
					<f:facet name="header">Ritorno</f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo_r.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo_r.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo_r.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo_r.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo_r.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo_r.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo_r.costo} €" />
					</p:column>
					
				

				</p:dataTable>
				
				<p:commandButton value="Aggiungi" styleClass="btn btn-default"
				action="#{bookBean.prenota(frontendBean.pacchetto)}"
				process="@this,prenota"/>
				
				
				

			</h:form>
			
			<p:dialog header="Error" widgetVar="errorDialog" resizable="false">
				<p:panel>
					<h:outputText value="You have to select one departure flight and one arrival flight" />
				</p:panel>
			</p:dialog>
			
			</p:dialog>

		<p:dialog header="Hotel" widgetVar="hotelDialog" resizable="false">
		
			<h:form id="formHotel">

				<p:dataTable id="hotelDisponibili" var="hotel"
					value="#{bookBean.hotelDisponibili}">
					<f:facet name="header">  
            		Elenco Hotel 
       				 </f:facet>

					<p:column sortBy="nome" headerText="Nome" filterBy="#{hotel.nome}">
						<h:outputText value="#{hotel.nome}" />
					</p:column>

					<p:column sortBy="stelle" headerText="Stelle">
						<h:outputText value="#{hotel.stelle}" />
					</p:column>

					<p:column sortBy="costoGiornaliero" headerText="Costo giornaliero">
						<h:outputText value="#{hotel.costoGiornaliero} €" />
					</p:column>

					<p:column sortBy="luogo" headerText="Luogo">
						<h:outputText value="#{hotel.luogo}" />
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{hotel.disponibilita}" />
					</p:column>
					
					<p:column>
				
					<h:commandLink id="cambia" value="Scegli" class="btn btn-default"
						action="#{bookBean.cambiaHotel(frontendBean.pacchetto, hotel)}" onclick="PF('hotelDialog').hide();">
						<p:ajax execute="aggiungi" update=":form:displayHotel" />
					</h:commandLink>
						
				</p:column>
				
				</p:dataTable>


			</h:form>



		</p:dialog>


		<p:dialog header="Attivita Secondarie" widgetVar="attivitaDialog2" resizable="false">

			<p:dataTable id="dataTableAttivita2" var="attivita"
				value="#{bookBean.listaAttivitaSecondarie}"
				lazy="true">
				<f:facet name="header">  
                Elenco Attivita Secondarie 
       		    </f:facet>
				<p:column sortBy="nome" headerText="Nome">
					<h:outputText value="#{attivita.nome}" />
				</p:column>

				<p:column sortBy="costoGiornaliero" headerText="Costo">
					<h:outputText value="#{attivita.costo} €" />
				</p:column>

				<p:column sortBy="luogo" headerText="Luogo">
					<h:outputText value="#{attivita.localita}" />
				</p:column>
				<p:column sortBy="disponibilita" headerText="Posti disponibili">
					<h:outputText value="#{attivita.disponibilita}" />
				</p:column>

				<p:column>
					<h:commandLink id="scegliAttivita" value="Scegli"
						class="btn btn-danger white"
						action="#{bookBean.scegliAttivita(action,attivita, frontendBean.pacchetto)}">
						<p:ajax execute="scegliAttivita"  update=":form:dataTableAttivita,dataTableAttivita2" />
					</h:commandLink>
				</p:column>
				
			</p:dataTable>

		</p:dialog>
		
		<p:dialog header="Scegli Voli" widgetVar="scegliVoliDialog" resizable="false">
			<h:form id="scegliVoliNuovi">
			
				
				<h:outputText value = "Andata" />
				<h:inputText value = "#{bookBean.andataPartenza}" />
				<h:outputText value = "Andata" />
				<h:inputText value = "#{bookBean.andataArrivo}" />
				<p:commandButton value="Ricerca" styleClass="btn btn-default"
				action="#{bookBean.ricercaVoli()}"
				update=":form:scegliVoliNuovi:displayAndataNuovi"
				process="@this,scegliVoliNuovi"/>
				
				<p:dataTable id="displayAndataNuovi" var="volo"
					value="#{bookBean.listaVoliAndata}"  selection="#{bookBean.voloAndata}" selectionMode="single" rowKey="#{volo.id}">
					<f:facet name="header"> Andata  </f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo.costo} €" />
					</p:column>
					
					
				</p:dataTable>
				
				
				<h:outputText value = "Ritorno" />
				<h:inputText value = "#{bookBean.ritornoPartenza}" />
				<h:outputText value = "Andata" />
				<h:inputText value = "#{bookBean.ritornoArrivo}" />
				<p:commandButton value="Ricerca" styleClass="btn btn-default"
				action="#{bookBean.ricercaVoli()}"
				update=":form:scegliVoliNuovi:displayRitornoNuovi"
				process="@this,scegliVoliNuovi"/>
			
				
				<p:dataTable id="displayRitornoNuovi" var="volo"
					value="#{bookBean.listaVoliRitorno}"  selection="#{bookBean.voloRitorno}" selectionMode="single" rowKey="#{volo.id}">
					<f:facet name="header"> Andata  </f:facet>
					<p:column sortBy="nomeCompagnia" headerText="Compagnia aerea">
						<h:outputText value="#{volo.nomeCompagnia}" />
					</p:column>

					<p:column sortBy="cittaPartenza" headerText="Città di partenza">
						<h:outputText value="#{volo.cittaPartenza}" />
					</p:column>

					<p:column sortBy="cittaArrivo" headerText="Città di arrivo">
						<h:outputText value="#{volo.cittaArrivo}" />
					</p:column>

					<p:column sortBy="partenza" headerText="Data di Partenza">
						<h:outputText value="#{volo.partenza}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="arrivo" headerText="Data di arrivo">
						<h:outputText value="#{volo.arrivo}">
							<f:convertDateTime type="date" pattern="MM:dd:yyy HH:mm" />
						</h:outputText>
					</p:column>

					<p:column sortBy="disponibilita" headerText="Posti disponibili">
						<h:outputText value="#{volo.disponibilita}" />


					</p:column>

					<p:column sortBy="costo" headerText="Prezzo">
						<h:outputText value="#{volo.costo} €" />
					</p:column>
					
					
				</p:dataTable>
				

				<p:commandButton value="Prenota" styleClass="btn btn-default"
				action="#{bookBean.prenota(frontendBean.pacchetto)}"
				process="@this,scegliVoliNuovi"/>
				
				
			</h:form>
			
			<!--  
			<p:dialog header="Error" widgetVar="errorDialog" resizable="false">
				<p:panel>
					<h:outputText value="You have to select one departure flight and one arrival flight" />
				</p:panel>
			</p:dialog>
			-->
			
			</p:dialog>



	</h:form>
</h:body>


</html>